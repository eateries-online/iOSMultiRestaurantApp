import{_ as B,P as q,m as v,p as a,S as n,f as e,s as t,ax as w,F as d,a3 as x,V as _,a2 as f,X as c,R as m,q as h,ap as V,U as k,aw as b,a4 as L,a5 as P,aV as C,a8 as D,aa as I,a9 as y,b1 as T,a$ as z}from"./index.30bcee2d.js";import{Q as N}from"./QToolbarTitle.80059bbe.js";import{Q as R}from"./QToolbar.8b90f7d3.js";import{Q as U}from"./QHeader.b4bada8e.js";import{Q}from"./QSkeleton.8077f081.js";import{Q as j}from"./QTab.9fbd659e.js";import{Q as A}from"./QTabs.3876ad2a.js";import{Q as F}from"./QSpace.274cde1f.js";import{Q as E}from"./QImg.4e876ad6.js";import{Q as S}from"./QItemLabel.b935a34d.js";import{Q as H}from"./QBadge.787b59b6.js";import{Q as O}from"./QList.d8ad41f7.js";import{Q as X}from"./QInnerLoading.1dad5a80.js";import{Q as G}from"./QSpinnerDots.3f00e075.js";import{Q as J}from"./QInfiniteScroll.c9142728.js";import{Q as K}from"./QPageScroller.8d9fce0a.js";import{Q as M}from"./QPage.f04658ef.js";import{Q as W}from"./QPullToRefresh.e8308158.js";import{Q as Y}from"./QForm.ab8a2cd2.js";/* empty css                   */import{u as Z}from"./BookingStore.084d743d.js";import"./QResizeObserver.3c3b4a7a.js";import"./rtl.b51694b1.js";import"./use-page-sticky.73584e0a.js";import"./touch.3df10340.js";import"./selection.c88e3f6c.js";import"./format.2bc25e5f.js";const $={name:"BookingList",setup(){const o=q(),s=Z();return{DataStore:o,BookingStore:s}},data(){return{dialog:!1,loading:!1,status:[],tabs:"all",data:[],merchant:[],table_list:[],page:0,is_refresh:void 0,q:""}},created(){this.BookingStore.getBookingSummary()},watch:{tabs(o,s){console.log(o),this.resetPage()}},computed:{hasData(){return Object.keys(this.data).length>0}},methods:{refresh(o){this.resetPage(),this.is_refresh=o},resetPage(){this.resetPagination()},resetPagination(){this.page=0,this.data=[],this.merchant=[],this.table_list=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},BookingList(o,s){this.loading=!0,this.page=o,v.fetchDataPostTable2("BookingList","page="+o+"&status="+this.tabs).then(u=>{u.code==1?(this.data.push(u.details.data),this.merchant=u.details.merchant,this.table_list=u.details.table_list):this.$refs.nscroll.stop()}).catch(u=>{this.$refs.nscroll&&this.$refs.nscroll.stop()}).then(u=>{this.loading=!1,s(),v.empty(this.is_refresh)||this.is_refresh()})},onSubmit(){this.$router.push({path:"/booking/search",query:{q:this.q}})}}},ee={class:"q-pa-md bg-grey-1 q-mb-sm radius8"},te={class:"row items-center q-gutter-md"},oe={class:"col"},ae={class:"no-margin"},re=f("0"),se={class:"font12 no-margin"},le={class:"border-dark-grey radius28"},ie={key:0,class:"flex flex-center",style:{"min-height":"300px"}},ne={class:"text-grey"},de={key:0,class:"q-pa-xl"},me={key:1,class:"row justify-center absolute-bottom"};function ue(o,s,u,g,r,p){return a(),n(d,null,[e(W,{onRefresh:p.refresh},{default:t(()=>[e(U,{reveal:"","reveal-offset":"50",class:x({"bg-mydark text-white":o.$q.dark.mode,"bg-white text-dark":!o.$q.dark.mode})},{default:t(()=>[e(R,null,{default:t(()=>[e(_,{onClick:s[0]||(s[0]=l=>o.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:o.$q.dark.mode?"white":"dark"},null,8,["color"]),e(N,{class:"text-weight-bold"},{default:t(()=>[f(c(o.$t("Bookings")),1)]),_:1}),e(_,{flat:"",round:"",dense:"",icon:"search",color:"grey",onClick:s[1]||(s[1]=l=>r.dialog=!r.dialog)})]),_:1})]),_:1},8,["class"]),e(M,{class:"q-pl-md q-pr-md"},{default:t(()=>[m("div",ee,[m("div",te,[m("div",null,[g.BookingStore.summary_loading?(a(),h(Q,{key:0,type:"QAvatar"})):(a(),h(V,{key:1,color:"grey-4",name:"table_restaurant",style:{"font-size":"60px"}}))]),m("div",oe,[g.BookingStore.summary_loading?(a(),n(d,{key:0},[e(Q,{type:"text",class:"text-subtitle1"}),e(Q,{type:"text",width:"50%",class:"text-subtitle1"})],64)):(a(),n(d,{key:1},[m("h4",ae,[g.BookingStore.getSummary.total_reservation?(a(),n(d,{key:0},[f(c(g.BookingStore.getSummary.total_reservation),1)],64)):(a(),n(d,{key:1},[re],64))]),m("p",se,c(o.$t("Total Bookings")),1)],64))])])]),m("div",le,[e(A,{modelValue:r.tabs,"onUpdate:modelValue":s[2]||(s[2]=l=>r.tabs=l),class:"text-grey bigtabs","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":"","no-caps":""},{default:t(()=>[(a(!0),n(d,null,k(g.DataStore.getBookingStatusList,(l,i)=>(a(),h(j,{key:l,name:i,label:l},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),e(F,{class:"q-pa-sm"}),!p.hasData&&!r.loading?(a(),n("div",ie,[m("p",ne,c(o.$t("No data available")),1)])):b("",!0),e(J,{ref:"nscroll",onLoad:p.BookingList,offset:250},{loading:t(()=>[r.page<=1?(a(),n("div",de,[e(X,{showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})])):r.page>2?(a(),n("div",me,[e(G,{color:"secondary",size:"40px"})])):b("",!0)]),default:t(()=>[e(O,null,{default:t(()=>[(a(!0),n(d,null,k(r.data,l=>(a(),n(d,{key:l},[(a(!0),n(d,null,k(l,i=>(a(),n(d,{key:i.reservation_id},[e(D,{clickable:"",to:{path:"/booking/track",query:{id:i.reservation_uuid}}},{default:t(()=>[r.merchant[i.merchant_id]?(a(),h(y,{key:0,avatar:""},{default:t(()=>[e(I,{square:"",class:"rounded-borders"},{default:t(()=>[e(E,{src:r.merchant[i.merchant_id].url_logo,"spinner-size":"xs","spinner-color":"primary",style:{width:"80px",height:"80px"},fit:"cover"},null,8,["src"])]),_:2},1024)]),_:2},1024)):b("",!0),e(y,null,{default:t(()=>[r.merchant[i.merchant_id]?(a(),h(S,{key:0},{default:t(()=>[f(c(r.merchant[i.merchant_id].restaurant_name),1)]),_:2},1024)):b("",!0),e(S,{caption:""},{default:t(()=>[f(c(i.booking_id),1)]),_:2},1024),e(S,{caption:"",class:"font11"},{default:t(()=>[f(c(i.reservation_date_raw),1)]),_:2},1024)]),_:2},1024),e(y,{side:""},{default:t(()=>[e(H,{rounded:"",label:i.status,style:T({"background-color":`${i.status_color.background}`,color:`${i.status_color.color}`})},null,8,["label","style"])]),_:2},1024)]),_:2},1032,["to"]),e(z,{spaced:"",inset:""})],64))),128))],64))),128))]),_:1})]),_:1},8,["onLoad"]),e(K,{position:"bottom-right","scroll-offset":150,offset:[18,18]},{default:t(()=>[e(_,{fab:"",icon:"keyboard_arrow_up",color:"mygrey","text-color":"dark",dense:"",padding:"3px"})]),_:1})]),_:1})]),_:1},8,["onRefresh"]),e(w,{modelValue:r.dialog,"onUpdate:modelValue":s[4]||(s[4]=l=>r.dialog=l),position:"top","full-width":"","transition-show":"fade","transition-hide":"fade"},{default:t(()=>[e(L,null,{default:t(()=>[e(P,null,{default:t(()=>[e(Y,{onSubmit:p.onSubmit},{default:t(()=>[e(C,{modelValue:r.q,"onUpdate:modelValue":s[3]||(s[3]=l=>r.q=l),label:o.$t("Search Booking"),outlined:"","lazy-rules":"","bg-color":o.$q.dark.mode?"grey600":"input","label-color":o.$q.dark.mode?"grey300":"grey",borderless:"",class:"input-borderless cursor-pointer"},{append:t(()=>[e(_,{onClick:p.onSubmit,round:"",color:"primary",flat:"",icon:"eva-search-outline"},null,8,["onClick"])]),_:1},8,["modelValue","label","bg-color","label-color"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var je=B($,[["render",ue]]);export{je as default};
