import{_ as f,l as m,m as o,as as _,n as p,p as c,S as l,f as t,s as n,F as d,V as u,a4 as g,a5 as y,a$ as b,t as w,a2 as v,R as a}from"./index.30bcee2d.js";import{Q as x}from"./QToolbarTitle.80059bbe.js";import{Q as A}from"./QToolbar.8b90f7d3.js";import{Q as k}from"./QHeader.b4bada8e.js";import{Q}from"./QSpace.274cde1f.js";import{Q as q}from"./QInnerLoading.1dad5a80.js";import{Q as C}from"./QPage.f04658ef.js";import"./QResizeObserver.3c3b4a7a.js";const D={name:"ManageAccount",components:{StepsVerification:m(()=>w(()=>import("./StepsVerification.36fa72d5.js"),["assets/StepsVerification.36fa72d5.js","assets/QSpace.274cde1f.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QToolbar.8b90f7d3.js","assets/QForm.ab8a2cd2.js","assets/QInnerLoading.1dad5a80.js"]))},data(){return{loading:!1,code:"",account_deleted:!1}},methods:{requestData(){o.requestData().then(e=>{}).catch(e=>{o.notify("red-5",e,"error_outline",this.$q)}).then(e=>{})},beforeDelete(){this.loading=!0,this.code="",o.RequestEmailCode().then(e=>{this.sent_message=e.msg,this.show_modal=!1,this.$refs.steps_verification.show_modal=!0}).catch(e=>{o.notify("negative",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})},afterVerifycode(e){this.code=e,o.verifyAccountDelete(e).then(s=>{this.$refs.steps_verification.show_modal=!1,this.confirmDeletion()}).catch(s=>{o.notify("red-5",s,"error_outline",this.$q)}).then(s=>{this.loading=!1})},confirmDeletion(){this.$q.dialog({title:"Confirm account deletion",message:`Are you sure you want to delete your account and customer data? 
  This action is permanent and cannot be undone.`,persistent:!0,position:"bottom",ok:{unelevated:!0,color:"warning",rounded:!1,"text-color":"black",size:"md",label:"Yes delete my account","no-caps":!0},cancel:{unelevated:!0,rounded:!1,color:"grey-3","text-color":"black",size:"md",label:"Cancel","no-caps":!0}}).onOk(()=>{this.deleteAccount()}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})},deleteAccount(){this.loading=!0,o.deleteAccount(this.code).then(e=>{this.account_deleted=!0,setTimeout(()=>{_.logout(),this.$router.push("/home")},5e3)}).catch(e=>{o.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})}}},V=v(" Manage Account "),S=a("div",null,null,-1),T=a("div",{class:"text-h6 text-weight-bold"}," Your account is being deleted ",-1),$=a("p",{class:"font12"}," You will be automatically logged out. Your account will be deleted in the next few minutes. ",-1),Y=a("p",{class:"font12"}," Note: We may retain some information when permitted by law. ",-1),z=a("div",{class:"text-h6"},"Account Data",-1),R=a("p",{class:"font12"}," You can request an archive of your personal information. We'll notify you when it's ready to download. ",-1),B=a("div",{class:"text-h6"},"Delete Account",-1),E=a("p",{class:"font12"}," You can request to have your account deleted and personal information removed. If you have both a eateries and Caviar account, then the information associated with both will be affected to the extent we can identify that the accounts are owned by the same user. ",-1);function I(e,s,N,P,i,r){const h=p("StepsVerification");return c(),l(d,null,[t(k,{class:"bg-white"},{default:n(()=>[t(A,null,{default:n(()=>[t(u,{to:"/account/profile",flat:"",round:"",dense:"",icon:"arrow_back",color:"dark",disable:i.account_deleted},null,8,["disable"]),t(x,{class:"text-dark text-center text-weight-bold"},{default:n(()=>[V]),_:1}),S]),_:1})]),_:1}),t(C,{padding:"",class:"bg-grey-2"},{default:n(()=>[t(Q,{class:"q-pa-xs"}),t(g,{flat:"",class:"radius8"},{default:n(()=>[t(y,{class:"q-pa-md"},{default:n(()=>[i.account_deleted?(c(),l(d,{key:0},[T,$,Y],64)):(c(),l(d,{key:1},[z,R,t(u,{onClick:r.requestData,label:"Request Archive",size:"md",flat:"",dense:"","text-color":"primary","no-caps":""},null,8,["onClick"]),t(b,{spaced:""}),B,E,t(u,{onClick:r.beforeDelete,label:"Request Delete Account",size:"md",flat:"",dense:"","text-color":"primary","no-caps":""},null,8,["onClick"])],64))]),_:1}),t(q,{showing:i.loading,color:"primary",size:"md"},null,8,["showing"])]),_:1}),t(h,{ref:"steps_verification",sent_message:e.sent_message,phone_prefix:e.phone_prefix,phone_number:e.phone_number,onAfterVerifycode:r.afterVerifycode},null,8,["sent_message","phone_prefix","phone_number","onAfterVerifycode"])]),_:1})],64)}var J=f(D,[["render",I]]);export{J as default};
