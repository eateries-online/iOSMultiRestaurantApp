import{_ as D,m as p,p as s,q as k,s as a,f as t,V as B,a2 as g,X as d,a3 as u,R as h,ap as L,S as r,F as m,aw as _,U as b,a8 as v,a9 as y,a$ as q}from"./index.30bcee2d.js";import{Q as A}from"./QToolbarTitle.80059bbe.js";import{Q as I}from"./QToolbar.8b90f7d3.js";import{Q as z}from"./QHeader.b4bada8e.js";import{Q}from"./QSkeleton.8077f081.js";import{Q as x}from"./QTab.9fbd659e.js";import{Q as C}from"./QTabs.3876ad2a.js";import{Q as P}from"./QItemLabel.b935a34d.js";import{Q as T}from"./QList.d8ad41f7.js";import{Q as w}from"./QInnerLoading.1dad5a80.js";import{Q as S}from"./QSpinnerDots.3f00e075.js";import{Q as $}from"./QInfiniteScroll.c9142728.js";import{Q as N,a as V}from"./QTabPanels.4c083028.js";import{Q as M}from"./QPage.f04658ef.js";import{Q as j}from"./QPullToRefresh.e8308158.js";import"./QResizeObserver.3c3b4a7a.js";import"./rtl.b51694b1.js";import"./use-panel.f723744b.js";import"./touch.3df10340.js";import"./selection.c88e3f6c.js";import"./use-cache.b0833c75.js";import"./format.2bc25e5f.js";const R={name:"PointsPage",data(){return{tab:"transaction",loading:!1,loading_balance:!0,data:[],page:0,is_refresh:void 0,merchant_refresh:void 0,balance:0,loading_merchant:!1,data_merchant:[],page_merchant:0}},created(){this.getAvailablePoints()},computed:{hasData(){return Object.keys(this.data).length>0},hasDataMerchant(){return Object.keys(this.data_merchant).length>0}},methods:{tabChange(e){e=="transaction"?this.data=[]:this.data_merchant=[]},getAvailablePoints(){this.loading_balance=!0,p.fetchDataByTokenPost("getAvailablePoints").then(e=>{e.code==1?this.balance=e.details.total:this.balance=0}).catch(e=>{}).then(e=>{this.loading_balance=!1})},getPointsTransaction(e,l){this.loading=!0,this.page=e,p.fetchDataByTokenPost("getPointsTransaction","page="+e).then(o=>{console.log(o),o.code==1?this.data.push(o.details.data):this.$refs.nscroll.stop()}).catch(o=>{this.$refs.nscroll&&this.$refs.nscroll.stop()}).then(o=>{this.loading=!1,l(),p.empty(this.is_refresh)||this.is_refresh()})},refresh(e){this.tab=="transaction"?(this.resetPage(),this.is_refresh=e,this.getAvailablePoints()):(this.resetPagination2(),this.merchant_refresh=e)},resetPage(){this.resetPagination()},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},resetPagination2(){this.page_merchant=0,this.data_merchant=[],this.$refs.merchantScroll.reset(),this.$refs.merchantScroll.resume(),this.$refs.merchantScroll.trigger()},getPointsTransactionMerchant(e,l){this.loading_merchant=!0,this.page_merchant=e,p.fetchDataByTokenPost("getPointsTransactionMerchant","page="+e).then(o=>{console.log(o),o.code==1?this.data_merchant.push(o.details.data):this.$refs.merchantScroll.stop()}).catch(o=>{this.$refs.merchantScroll&&this.$refs.merchantScroll.stop()}).then(o=>{this.loading_merchant=!1,l(),p.empty(this.merchant_refresh)||this.merchant_refresh()})}}},U={class:"row items-center q-gutter-md"},F={class:"col"},O={class:"no-margin"},E={class:"font12 no-margin"},H={key:0,class:"flex flex-center",style:{"min-height":"300px"}},X={class:"text-grey"},G={key:0,class:"q-pa-xl"},J={key:1,class:"row justify-center absolute-bottom"},K={key:0,class:"flex flex-center",style:{"min-height":"300px"}},W={class:"text-grey"},Y={class:"text-bold text-green"},Z={key:0,class:"q-pa-xl"},ee={key:1,class:"row justify-center absolute-bottom"};function te(e,l,o,ae,n,f){return s(),k(j,{onRefresh:f.refresh},{default:a(()=>[t(z,{reveal:"","reveal-offset":"50",class:u({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:a(()=>[t(I,null,{default:a(()=>[t(B,{onClick:l[0]||(l[0]=i=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),t(A,{class:"text-weight-bold"},{default:a(()=>[g(d(e.$t("Points")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(M,{class:"q-pl-md q-pr-md"},{default:a(()=>[h("div",{class:u(["q-pa-md bg-grey-1x q-mb-sm radius8",{"bg-grey600 text-white":e.$q.dark.mode,"bg-grey-1 text-black":!e.$q.dark.mode}])},[h("div",U,[h("div",null,[n.loading_balance?(s(),k(Q,{key:0,type:"QAvatar"})):(s(),k(L,{key:1,color:"grey-4",name:"card_giftcard",style:{"font-size":"60px"}}))]),h("div",F,[n.loading_balance?(s(),r(m,{key:0},[t(Q,{type:"text"}),t(Q,{type:"text"})],64)):(s(),r(m,{key:1},[h("h4",O,d(n.balance),1),h("p",E,d(e.$t("Available Points")),1)],64))])])],2),t(C,{modelValue:n.tab,"onUpdate:modelValue":[l[1]||(l[1]=i=>n.tab=i),f.tabChange],dense:"","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":"","no-caps":"",class:u({"text-grey300":e.$q.dark.mode,"text-dark":!e.$q.dark.mode}),breakpoint:0},{default:a(()=>[t(x,{name:"transaction",label:e.$t("Transactions"),"no-caps":"","content-class":"text-weight-500 "},null,8,["label"]),t(x,{name:"points_merchant",label:e.$t("Points by merchant"),"no-caps":"","content-class":"text-weight-500 "},null,8,["label"])]),_:1},8,["modelValue","class","onUpdate:modelValue"]),t(N,{modelValue:n.tab,"onUpdate:modelValue":l[2]||(l[2]=i=>n.tab=i),animated:"","transition-next":"fade","transition-prev":"fade",class:u({"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode})},{default:a(()=>[t(V,{name:"transaction",class:"q-pl-none q-pr-none",style:{"min-height":"300px"}},{default:a(()=>[t($,{ref:"nscroll",onLoad:f.getPointsTransaction,offset:250},{default:a(()=>[!f.hasData&&!n.loading?(s(),r("div",H,[h("p",X,d(e.$t("No data available")),1)])):_("",!0),t(T,null,{default:a(()=>[(s(!0),r(m,null,b(n.data,i=>(s(),r(m,{key:i},[(s(!0),r(m,null,b(i,c=>(s(),r(m,{key:c.transaction_date},[t(v,null,{default:a(()=>[t(y,null,{default:a(()=>[t(P,null,{default:a(()=>[g(d(c.transaction_description),1)]),_:2},1024),t(P,{caption:""},{default:a(()=>[g(d(c.transaction_date),1)]),_:2},1024)]),_:2},1024),t(y,{side:""},{default:a(()=>[h("div",{class:u(["text-bold",{"text-green":c.transaction_type=="credit","text-red":c.transaction_type=="debit"}])},d(c.transaction_amount),3)]),_:2},1024)]),_:2},1024),t(q,{spaced:"",inset:""})],64))),128))],64))),128))]),_:1})]),loading:a(()=>[n.page<=1?(s(),r("div",G,[t(w,{showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})])):n.page>2?(s(),r("div",J,[t(S,{color:"secondary",size:"40px"})])):_("",!0)]),_:1},8,["onLoad"])]),_:1}),t(V,{name:"points_merchant",class:"q-pl-none q-pr-none",style:{"min-height":"300px"}},{default:a(()=>[t($,{ref:"merchantScroll",onLoad:f.getPointsTransactionMerchant,offset:250},{default:a(()=>[!f.hasDataMerchant&&!n.loading_merchant?(s(),r("div",K,[h("p",W,d(e.$t("No data available")),1)])):_("",!0),t(T,null,{default:a(()=>[(s(!0),r(m,null,b(n.data_merchant,i=>(s(),r(m,{key:i},[(s(!0),r(m,null,b(i,c=>(s(),r(m,{key:c.total_earning},[t(v,null,{default:a(()=>[t(y,null,{default:a(()=>[t(P,null,{default:a(()=>[g(d(c.restaurant_name),1)]),_:2},1024)]),_:2},1024),t(y,{side:""},{default:a(()=>[h("div",Y,d(c.total_earning),1)]),_:2},1024)]),_:2},1024),t(q,{spaced:"",inset:""})],64))),128))],64))),128))]),_:1})]),loading:a(()=>[n.page_merchant<=1?(s(),r("div",Z,[t(w,{showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})])):n.page_merchant>2?(s(),r("div",ee,[t(S,{color:"secondary",size:"40px"})])):_("",!0)]),_:1},8,["onLoad"])]),_:1})]),_:1},8,["modelValue","class"])]),_:1})]),_:1},8,["onRefresh"])}var xe=D(R,[["render",te]]);export{xe as default};
