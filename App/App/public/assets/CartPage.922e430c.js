import{_ as A,l as _,P as R,m as n,n as d,p as l,S,f as r,s as o,q as u,a3 as C,aw as m,F as v,V as p,a2 as V,X as c,R as i,a8 as O,a9 as k,bx as E,ap as x,t as f}from"./index.30bcee2d.js";import{Q as T}from"./QToolbarTitle.80059bbe.js";import{Q as U}from"./QToolbar.8b90f7d3.js";import{Q as M}from"./QHeader.b4bada8e.js";import{Q as L}from"./QImg.4e876ad6.js";import{Q as B}from"./QList.d8ad41f7.js";import{Q as z}from"./QPage.f04658ef.js";import{Q as N}from"./QPullToRefresh.e8308158.js";import{Q as Y}from"./QInnerLoading.1dad5a80.js";import{Q as j}from"./QFooter.f2cd3c2a.js";import{u as F}from"./CartStore.fe06611f.js";import{u as H}from"./DeliverySched.7aa22819.js";import"./QResizeObserver.3c3b4a7a.js";import"./touch.3df10340.js";import"./selection.c88e3f6c.js";import"./format.2bc25e5f.js";const J={name:"CartPage",components:{CartMerchantInfo:_(()=>f(()=>import("./CartMerchantInfo.ffc7aef8.js"),["assets/CartMerchantInfo.ffc7aef8.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QImg.4e876ad6.js","assets/CartStore.fe06611f.js"])),CartDetails:_(()=>f(()=>import("./CartDetails.0e36a007.js"),["assets/CartDetails.0e36a007.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QSkeleton.8077f081.js","assets/QList.d8ad41f7.js","assets/QImg.4e876ad6.js","assets/QItemLabel.b935a34d.js","assets/QSlideItem.4ba6d61d.js","assets/QPullToRefresh.e8308158.js","assets/touch.3df10340.js","assets/selection.c88e3f6c.js","assets/format.2bc25e5f.js","assets/use-cache.b0833c75.js","assets/CartStore.fe06611f.js"])),DeliveryDetails:_(()=>f(()=>import("./DeliveryDetails.f2af7b21.js"),["assets/DeliveryDetails.f2af7b21.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QBtnToggle.c946cab5.js","assets/QBtnGroup.d73b976b.js","assets/QItemLabel.b935a34d.js","assets/QList.d8ad41f7.js","assets/PlaceStore.c2f2bb5a.js","assets/DeliverySched.7aa22819.js"])),DeliverySched:_(()=>f(()=>import("./DeliverySched.d1de5213.js"),["assets/DeliverySched.d1de5213.js","assets/QBtnToggle.c946cab5.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QBtnGroup.d73b976b.js","assets/QSelect.a5140148.js","assets/QChip.9a5e9391.js","assets/QItemLabel.b935a34d.js","assets/QMenu.3f2e45b1.js","assets/selection.c88e3f6c.js","assets/rtl.b51694b1.js","assets/format.2bc25e5f.js","assets/DeliverySched.7aa22819.js"])),SimilarItems:_(()=>f(()=>import("./SimilarItems.9718629c.js"),["assets/SimilarItems.9718629c.js","assets/swiper.min.b39a1361.css","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QSkeleton.8077f081.js","assets/QImg.4e876ad6.js","assets/CartStore.fe06611f.js","assets/MenuStore.d5ae1ce3.js","assets/swiper-slide.7721ccad.js"])),ComponentsRealtime:_(()=>f(()=>import("./ComponentsRealtime.082a6132.js"),["assets/ComponentsRealtime.082a6132.js","assets/index.4f152a18.js","assets/index.30bcee2d.js","assets/index.aba08127.css"]))},data(){return{payload:["items","subtotal","distance_local","items_count","merchant_info","check_opening","transaction_info"],back_url:"/cart?refresh=1",lastPath:"",data_slide:{},include_utensils:!1}},setup(){const e=F(),a=H(),h=R();return{CartStore:e,DeliveryschedStore:a,DataStore:h}},created(){this.CartStore.getCart(!0,this.payload);const e=n.getStorage("include_utensils");n.empty(e)||(this.include_utensils=e),this.DeliveryschedStore.getDeliverySched(n.getStorage("cart_uuid"),n.getStorage("merchant_slug"),"cart")},mounted(){this.lastPath=this.$router.options.history.state.back},computed:{getMerchantUUID(){return Object.keys(this.CartStore.cart_merchant).length>0?this.CartStore.cart_merchant.merchant_uuid:!1}},methods:{backPage(){this.lastPath.search("map")>0?this.$router.push({name:"menu",params:{slug:this.CartStore.cart_merchant.slug}}):this.$router.back()},afterSavetrans(){this.CartStore.getCart(!1,this.payload),console.log("afterSavetrans"),this.DeliveryschedStore.getDeliverySched(n.getStorage("cart_uuid"),n.getStorage("merchant_slug"))},afterSavetranstype(){this.CartStore.getCart(!1,this.payload)},onClickchange(){this.$refs.delivery_details.showModal(!0)},showSched(){this.$refs.delivery_details.showModal(!1),this.$refs.delivery_sched.showSched(!0)},onRight(e,a){this.data_slide[a]=e},closeSlide(e){this.data_slide[e]&&this.data_slide[e].reset()},setUtensil(e){n.setStorage("include_utensils",e)},refresh(e){this.CartStore.getCart(!1,this.payload),e()},checkBeforeCheckout(){if(console.log(this.CartStore.transaction_info.whento_deliver),this.CartStore.transaction_info.whento_deliver=="schedule"){let e="You are placing and order for {date} at {time}. Would you like to continue?";e=e.replace("{date}",this.CartStore.transaction_info.delivery_date_pretty),e=e.replace("{time}",this.CartStore.transaction_info.delivery_time.pretty_time),this.$q.dialog({title:"Ordering for later?",message:e,persistent:!0,position:"standard",transitionShow:"fade",transitionHide:"fade",ok:{unelevated:!0,color:"primary",rounded:!1,"text-color":"white",size:"md",label:"Continue","no-caps":!0},cancel:{unelevated:!0,rounded:!1,color:"grey-3","text-color":"black",size:"md",label:"Cancel","no-caps":!0}}).onOk(()=>{this.$router.push("/checkout")}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})}else this.$router.push("/checkout")},afterSetplaceid(){this.CartStore.getCart(!0,this.payload)},afterReceive(e){console.log("afterReceive"),console.log(e);let a=JSON.parse(e.message);console.log(a),n.fetchDataPost("validateCartItems","item_id="+a.item_id+"&cart_uuid="+n.getStorage("cart_uuid")).then(h=>{this.$q.dialog({title:this.$t("Items"),message:h.msg,persistent:!0}).onOk(()=>{this.CartStore.getCart(!0,this.payload)}).onCancel(()=>{}).onDismiss(()=>{})}).catch(h=>{}).then(h=>{})}}},W={key:0,class:"text-center full-width"},X={class:"text-h5 text-weight-bold"},G={class:"text-grey font12"},K={key:0,class:"q-pl-md q-pr-md"},Z={class:"text-weight-bold font16"},$={class:"text-grey"},ee={class:"row justify-end"},te={class:"q-pl-sm"},re={class:"row items-center justify-between fit"},ae={class:"text-weight-bold font17"},oe={class:"text-weight-bold font16"};function se(e,a,h,t,g,s){const b=d("CartMerchantInfo"),D=d("CartDetails"),w=d("SimilarItems"),I=d("DIV"),q=d("DeliveryDetails"),Q=d("DeliverySched"),P=d("ComponentsRealtime");return l(),S(v,null,[r(N,{onRefresh:s.refresh},{default:o(()=>[r(M,{reveal:"","reveal-offset":"10",class:C({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-black":!e.$q.dark.mode})},{default:o(()=>[r(U,null,{default:o(()=>[r(p,{onClick:a[0]||(a[0]=y=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),r(T,{class:"text-weight-bold"},{default:o(()=>[V(c(e.$t("Your Order")),1)]),_:1}),t.CartStore.hasItem?(l(),u(p,{key:0,onClick:a[1]||(a[1]=y=>this.$refs.cart_details.clearCart()),flat:"",round:"",dense:"",icon:"las la-trash-alt",color:"secondary"})):m("",!0)]),_:1})]),_:1},8,["class"]),r(z,null,{default:o(()=>[!t.CartStore.hasItem&&!t.CartStore.cart_loading?(l(),S("div",W,[r(L,{src:"cart-empty.png",fit:"fill","spinner-color":"primary",style:{height:"80px","max-width":"80px"}}),i("div",X,c(e.$t("Your cart is empty")),1),i("p",G,c(e.$t("You don't have any orders here! let's change that!")),1)])):(l(),S(v,{key:1},[r(b,{ref:"cart_merchantinfo",show_transinfo:!0,onOnClickchange:s.onClickchange},null,8,["onOnClickchange"]),!t.CartStore.canProceed&&!t.CartStore.cart_loading?(l(),S("div",K,[i("div",{class:C(["q-pa-md radius8 font12",{"bg-grey600 text-grey300":e.$q.dark.mode,"bg-yellow text-dark":!e.$q.dark.mode}]),style:{bottom:"51px"}},c(t.CartStore.getErrorMsg),3)])):m("",!0),r(D,{ref:"cart_details",is_checkout:!0,payload:g.payload},null,8,["payload"]),!t.CartStore.cart_loading&&t.DataStore.enabled_include_utensils?(l(),u(B,{key:1,class:"border-grey-top"},{default:o(()=>[r(O,null,{default:o(()=>[r(k,null,{default:o(()=>[i("div",Z,c(e.$t("Cutlery")),1),i("div",$,c(e.$t("Include utensils, napkins, etc.")),1)]),_:1}),r(k,{side:""},{default:o(()=>[r(E,{modelValue:g.include_utensils,"onUpdate:modelValue":[a[2]||(a[2]=y=>g.include_utensils=y),s.setUtensil]},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})):m("",!0),t.CartStore.hasItem?(l(),u(I,{key:2,class:"q-pl-md q-pr-md border-grey-top"},{default:o(()=>[i("div",ee,[r(p,{unelevated:"",color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"grey","no-caps":"",size:"md",class:"radius8 q-mt-sm q-mb-md",to:{name:"menu",params:{slug:t.CartStore.cart_merchant.slug}}},{default:o(()=>[r(x,{name:"las la-plus",size:"15px"}),i("div",te,c(e.$t("Add more items")),1)]),_:1},8,["color","text-color","to"])]),t.CartStore.cart_merchant.merchant_id?(l(),u(w,{key:0,ref:"similar_items",title:e.$t("Most Order Items"),merchant_id:t.CartStore.cart_merchant.merchant_id},null,8,["title","merchant_id"])):m("",!0)]),_:1})):m("",!0)],64))]),_:1})]),_:1},8,["onRefresh"]),r(Y,{showing:t.CartStore.cart_reloading,color:"primary",size:"md","label-class":"dark"},null,8,["showing"]),t.CartStore.items_count>0?(l(),u(j,{key:0,reveal:"",class:C(["q-pl-md q-pr-md q-pb-sm q-pt-sm text-dark",{"bg-primary":!t.CartStore.cart_reloading,"bg-grey-5":t.CartStore.cart_reloading}])},{default:o(()=>[r(p,{onClick:s.checkBeforeCheckout,loading:t.CartStore.cart_loading,disable:!t.CartStore.canProceed,unelevated:"","text-color":"white","no-caps":"",class:"radius10 fit",color:{primary:!t.CartStore.cart_reloading,"grey-5":t.CartStore.cart_reloading}},{default:o(()=>[i("div",re,[i("div",ae,c(e.$t("Checkout")),1),i("div",oe,c(t.CartStore.cart_subtotal.value),1)])]),_:1},8,["onClick","loading","disable","color"])]),_:1},8,["class"])):m("",!0),r(q,{ref:"delivery_details",back_url:g.back_url,onShowSched:s.showSched,onAfterSavetrans:s.afterSavetrans,onAfterSavetranstype:s.afterSavetranstype,onAfterSetplaceid:s.afterSetplaceid},null,8,["back_url","onShowSched","onAfterSavetrans","onAfterSavetranstype","onAfterSetplaceid"]),r(Q,{ref:"delivery_sched",slug:t.CartStore.cart_merchant.slug,onAfterSavetrans:s.afterSavetrans},null,8,["slug","onAfterSavetrans"]),s.getMerchantUUID?(l(),u(P,{key:1,ref:"realtime",getevent:"cart",subscribe_to:s.getMerchantUUID,onAfterReceive:s.afterReceive},null,8,["subscribe_to","onAfterReceive"])):m("",!0)],64)}var ke=A(J,[["render",se]]);export{ke as default};
