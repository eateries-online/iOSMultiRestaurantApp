import{_ as M,l as U,P as R,m as _,n as D,p as n,S as d,f as l,s as a,a3 as v,F as g,q as B,V as h,aw as m,a2 as k,X as s,aV as c,U as T,R as i,a8 as Q,bc as E,bd as F,a9 as q,t as P}from"./index.30bcee2d.js";import{Q as z}from"./QToolbarTitle.80059bbe.js";import{Q as L}from"./QToolbar.8b90f7d3.js";import{Q as I}from"./QHeader.b4bada8e.js";import{Q as p}from"./QSelect.a5140148.js";import{Q as y}from"./QSpace.274cde1f.js";import{Q as V}from"./QFooter.f2cd3c2a.js";import{Q as N}from"./QImg.4e876ad6.js";import{Q as H}from"./QItemLabel.b935a34d.js";import{Q as G}from"./QForm.ab8a2cd2.js";import{Q as A}from"./QInnerLoading.1dad5a80.js";import{Q as Y}from"./QPage.f04658ef.js";import{u as O}from"./MenuStore.d5ae1ce3.js";import{u as X}from"./BookingStore.084d743d.js";import"./QResizeObserver.3c3b4a7a.js";import"./QChip.9a5e9391.js";import"./QMenu.3f2e45b1.js";import"./selection.c88e3f6c.js";import"./rtl.b51694b1.js";import"./format.2bc25e5f.js";const j={name:"BookingUpdate",components:{componentsRecaptcha:U(()=>P(()=>import("./componentsRecaptcha.89260bb2.js"),["assets/componentsRecaptcha.89260bb2.js","assets/index.30bcee2d.js","assets/index.aba08127.css"]))},data(){return{loading:!1,recaptcha_response:"",success_data:[],reservation_uuid:""}},setup(){const e=X(),t=O(),w=R();return{MenuStore:t,BookingStore:e,DataStore:w}},created(){this.BookingStore.steps=1,this.reservation_uuid=this.$route.query.id,this.Getbookingattributes()},methods:{Getbookingattributes(){this.reservation_uuid=this.$route.query.id,this.BookingStore.Getbookingdetails(this.reservation_uuid)},SetBooking(){this.BookingStore.SetBooking(this.BookingStore.merchant_uuid,this.reservation_uuid,this.$q)},recaptchaExpired(){_.empty(this.$refs.recapcha)&&this.$refs.recapcha.reset()},recaptchaFailed(){},recaptchaVerified(e){this.recaptcha_response=e},onSubmit(){this.loading=!0;let e="merchant_uuid="+this.BookingStore.merchant_uuid;e+="&reservation_date="+this.BookingStore.reservation_date,e+="&reservation_time="+this.BookingStore.reservation_time,e+="&guest="+this.BookingStore.guest,e+="&first_name="+this.BookingStore.first_name,e+="&last_name="+this.BookingStore.last_name,e+="&email_address="+this.BookingStore.email_address,e+="&mobile_prefix="+this.BookingStore.mobile_prefix,e+="&mobile_number="+this.BookingStore.mobile_number,e+="&room_uuid="+this.BookingStore.room_uuid,e+="&table_uuid="+this.BookingStore.table_uuid,e+="&special_request="+this.BookingStore.special_request,e+="&recaptcha_response="+this.recaptcha_response,e+="&id="+this.reservation_uuid,_.fetchDataPostTable2("ReserveTable",e).then(t=>{this.success_data=t.details,this.BookingStore.steps=3,this.BookingStore.room_uuid="",this.BookingStore.table_uuid=""}).catch(t=>{this.success_data=[],_.notify("dark",t,"error_outline",this.$q),this.recaptchaExpired()}).then(t=>{this.loading=!1})}}},J={key:0},K={key:0,class:"row q-gutter-sm"},W={class:"text-weight-bold font15 q-mt-md"},Z=["innerHTML"],$={class:"q-mt-sm text-weight-bold font15"},x={class:"text-grey"},ee={class:"q-mt-sm text-weight-bold font15"},oe={class:"q-mt-sm text-weight-medium font15"},re={class:"text-grey q-mt-md q-mb-md"},te={class:"text-center q-pa-xl"},le=i("svg",{class:"checkmark",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 52 52"},[i("circle",{class:"checkmark__circle",cx:"26",cy:"26",r:"25",fill:"none"}),i("path",{class:"checkmark__check",fill:"none",d:"M14.1 27.2l7.1 7.2 16.7-16.8"})],-1),ie={key:0,class:"font16 q-mb-none"},ae=["innerHTML"],se={class:"font16 q-mb-none"},ne={class:"text-grey"},de={class:"font15 line-normal q-mb-none"},me={class:"text-grey"},ge={class:"text-success"};function ue(e,t,w,o,f,b){const C=D("componentsRecaptcha");return n(),d(g,null,[l(I,{class:v(["bg-whitex",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode}]),reveal:""},{default:a(()=>[l(L,null,{default:a(()=>[o.BookingStore.steps!=3?(n(),B(h,{key:0,onClick:t[0]||(t[0]=r=>o.BookingStore.steps==1?e.$router.back():o.BookingStore.steps=1),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"])):m("",!0),o.BookingStore.steps!=3?(n(),B(z,{key:1,class:"text-weight-bold text-darkx"},{default:a(()=>[k(s(e.$t("Update Reservation")),1)]),_:1})):m("",!0)]),_:1})]),_:1},8,["class"]),l(Y,{class:v(["q-pl-md q-pr-md",{"flex flex-center":o.BookingStore.getErrors}])},{default:a(()=>[o.BookingStore.getErrors?(n(),d("div",J,s(o.BookingStore.getErrors),1)):m("",!0),o.BookingStore.hasData?(n(),d(g,{key:1},[o.BookingStore.getSteps==1?(n(),d(g,{key:0},[l(p,{modelValue:o.BookingStore.guest,"onUpdate:modelValue":[t[1]||(t[1]=r=>o.BookingStore.guest=r),t[2]||(t[2]=r=>o.BookingStore.getTimeslot(o.MenuStore.merchant_uuid))],options:o.BookingStore.guest_list,label:e.$t("Guest"),color:"primary",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":"",outlined:"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey"},null,8,["modelValue","options","label","bg-color","label-color"]),l(p,{modelValue:o.BookingStore.reservation_date,"onUpdate:modelValue":[t[3]||(t[3]=r=>o.BookingStore.reservation_date=r),t[4]||(t[4]=r=>o.BookingStore.getTimeslot(o.MenuStore.merchant_uuid))],options:o.BookingStore.date_list,label:e.$t("Date"),color:"primary",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"",outlined:"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey"},null,8,["modelValue","options","label","bg-color","label-color"]),l(c,{modelValue:o.BookingStore.reservation_time,"onUpdate:modelValue":t[5]||(t[5]=r=>o.BookingStore.reservation_time=r),label:e.$t("Time"),disable:"",outlined:"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey"},null,8,["modelValue","label","bg-color","label-color"]),l(y,{class:"q-pa-sm"}),o.BookingStore.hasTimeSlot?(n(),d("div",K,[(n(!0),d(g,null,T(o.BookingStore.getTimeList,r=>(n(),d(g,{key:r},[(n(!0),d(g,null,T(r,(u,S)=>(n(),d("div",{key:u,class:"col-2 text-center"},[l(h,{unelevated:"",label:u,class:"full-width",outline:!o.BookingStore.isSelected(S),color:o.BookingStore.isSelected(S)?e.$q.dark.mode?"grey300":"primary":o.BookingStore.isNotavailable(S)?"grey":e.$q.dark.mode?"grey300":"black",onClick:ke=>o.BookingStore.reservation_time=S,disabled:o.BookingStore.isNotavailable(S)},null,8,["label","outline","color","onClick","disabled"])]))),128))],64))),128))])):m("",!0),o.MenuStore.getBookingTc?(n(),d(g,{key:1},[i("div",W,s(e.$t("Restaurant Terms & Conditions")),1),i("div",{class:"text-grey",innerHTML:o.MenuStore.getBookingTc},null,8,Z)],64)):m("",!0),l(y,{class:"q-pa-md"}),l(V,{reveal:"",class:"bg-primary text-dark"},{default:a(()=>[l(h,{type:"submit",color:"primary",unelevated:"","no-caps":"",class:"fit",size:"lg",disabled:!o.BookingStore.bookingValid,loading:o.BookingStore.loading,onClick:b.SetBooking},{default:a(()=>[k(s(e.$t("Continue")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})],64)):m("",!0),o.BookingStore.getSteps==2?(n(),B(G,{key:1,onSubmit:b.onSubmit},{default:a(()=>[i("div",$,s(e.$t("Reservation details")),1),i("div",x,[i("div",null,s(o.BookingStore.reservation_info.full_time),1),i("div",null,s(o.BookingStore.reservation_info.guest),1)]),i("div",ee,s(e.$t("Personal details")),1),l(c,{modelValue:o.BookingStore.first_name,"onUpdate:modelValue":t[6]||(t[6]=r=>o.BookingStore.first_name=r),label:e.$t("First name"),outlined:"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey","lazy-rules":"",rules:[r=>r&&r.length>0||e.$t("This field is required")]},null,8,["modelValue","label","bg-color","label-color","rules"]),l(c,{modelValue:o.BookingStore.last_name,"onUpdate:modelValue":t[7]||(t[7]=r=>o.BookingStore.last_name=r),label:e.$t("Last name"),outlined:"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey","lazy-rules":"",rules:[r=>r&&r.length>0||e.$t("This field is required")]},null,8,["modelValue","label","bg-color","label-color","rules"]),l(c,{modelValue:o.BookingStore.email_address,"onUpdate:modelValue":t[8]||(t[8]=r=>o.BookingStore.email_address=r),label:e.$t("Email address"),outlined:"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey","lazy-rules":"",rules:[(r,u)=>u.email(r)||e.$t("Please enter a valid email address")]},null,8,["modelValue","label","bg-color","label-color","rules"]),l(c,{modelValue:o.BookingStore.mobile_number,"onUpdate:modelValue":t[10]||(t[10]=r=>o.BookingStore.mobile_number=r),mask:"##############",outlined:"","lazy-rules":"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey",borderless:"",class:"input-borderless",rules:[r=>r&&r.length>0||this.$t("This field is required")]},{prepend:a(()=>[l(p,{dense:"",modelValue:o.BookingStore.mobile_prefix,"onUpdate:modelValue":t[9]||(t[9]=r=>o.BookingStore.mobile_prefix=r),options:o.DataStore.phone_prefix_data,onFilter:e.filterFn,behavior:"dialog","input-debounce":"700",style:{border:"none"},"emit-value":"",borderlessx:"",class:"myq-field"},{option:a(({itemProps:r,opt:u})=>[l(Q,E(F(r)),{default:a(()=>[l(q,{avatar:""},{default:a(()=>[l(N,{src:u.flag,style:{height:"15px","max-width":"20px"}},null,8,["src"])]),_:2},1024),l(q,null,{default:a(()=>[l(H,null,{default:a(()=>[k(s(u.label),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":a(()=>[l(Q,null,{default:a(()=>[l(q,{class:"text-grey"},{default:a(()=>[k(s(e.$t("No results")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter"])]),_:1},8,["modelValue","bg-color","label-color","rules"]),o.MenuStore.allowChooseTable?(n(),d(g,{key:0},[l(p,{modelValue:o.BookingStore.room_uuid,"onUpdate:modelValue":[t[11]||(t[11]=r=>o.BookingStore.room_uuid=r),t[12]||(t[12]=r=>o.BookingStore.table_uuid="")],options:o.BookingStore.room_list,label:e.$t("Room name"),"transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"",rules:[r=>r&&r.length>0||e.$t("This field is required")]},null,8,["modelValue","options","label","rules"]),l(p,{modelValue:o.BookingStore.table_uuid,"onUpdate:modelValue":t[13]||(t[13]=r=>o.BookingStore.table_uuid=r),options:o.BookingStore.table_list[o.BookingStore.room_uuid],label:e.$t("Table name"),"transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"",rules:[r=>r&&r.length>0||e.$t("This field is required")]},null,8,["modelValue","options","label","rules"])],64)):m("",!0),i("div",oe,s(e.$t("Special request")),1),l(c,{modelValue:o.BookingStore.special_request,"onUpdate:modelValue":t[14]||(t[14]=r=>o.BookingStore.special_request=r),autogrow:"",color:"warning",outlined:"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey"},null,8,["modelValue","bg-color","label-color"]),o.MenuStore.isBookingCaptcha?(n(),d(g,{key:1},[l(y,{class:"q-pa-sm"}),l(C,{ref:"recapcha",is_enabled:"1",size:"normal",theme:"light",tabindex:0,sitekey:o.DataStore.getBookingSettings.site_key,language_code:o.DataStore.getBookingSettings.language,onVerify:b.recaptchaVerified,onExpire:b.recaptchaExpired,onFail:b.recaptchaFailed},null,8,["sitekey","language_code","onVerify","onExpire","onFail"])],64)):m("",!0),i("p",re,s(e.$t("By continuing, you agree to Terms of Service and Privacy Policy"))+". ",1),l(V,{reveal:"",class:"bg-primary text-dark"},{default:a(()=>[l(h,{type:"submit",color:"primary",unelevated:"","no-caps":"",class:"fit",size:"lg",loading:f.loading},{default:a(()=>[k(s(e.$t("Reserve")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["onSubmit"])):m("",!0),o.BookingStore.getSteps==3?(n(),d(g,{key:2},[i("div",te,[le,o.MenuStore.getBookingCustomMessage?(n(),d("h4",ie,[i("span",{innerHTML:o.MenuStore.getBookingCustomMessage},null,8,ae)])):(n(),d(g,{key:1},[i("h4",se,s(e.$t("Your reservation successfully placed"))+". ",1),i("p",ne,s(e.$t("You will receive another email once your reservation is confirm"))+". ",1)],64)),i("h5",de,s(f.success_data.full_time),1),i("div",me,[i("div",null,s(f.success_data.guest),1),i("div",null,[k(s(e.$t("Reservation ID"))+"# ",1),i("span",ge,s(f.success_data.reservation_id),1)])]),l(y,{class:"q-pa-md"})]),l(V,{class:v(["bg-primary text-dark",{"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},{default:a(()=>[l(h,{color:e.$q.dark.mode?"grey300":"primary",size:"lg",unelevated:"","no-caps":"",onClick:t[15]||(t[15]=r=>e.$router.back()),class:"fit"},{default:a(()=>[k(s(e.$t("Done")),1)]),_:1},8,["color"])]),_:1},8,["class"])],64)):m("",!0)],64)):m("",!0),o.BookingStore.loading?(n(),B(A,{key:2,showing:!0,color:e.$q.dark.mode?"grey300":"primary"},null,8,["color"])):m("",!0)]),_:1},8,["class"])],64)}var Ee=M(j,[["render",ue]]);export{Ee as default};
