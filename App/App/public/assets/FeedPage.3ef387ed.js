import{_ as I,l as h,P as M,m as c,as as P,n as u,p as i,q as f,s as n,f as r,V as k,S as a,a2 as p,X as _,F as l,aw as R,a3 as D,R as w,ap as S,U as q,t as y,a6 as C,a7 as E,a8 as V,aB as z}from"./index.30bcee2d.js";import{Q as B}from"./QToolbarTitle.80059bbe.js";import{Q as N}from"./QToolbar.8b90f7d3.js";import{Q as O}from"./QHeader.b4bada8e.js";import{Q as $}from"./QSkeleton.8077f081.js";import{Q as j}from"./QList.d8ad41f7.js";import{Q as H}from"./QSpinnerDots.3f00e075.js";import{Q as U}from"./QInfiniteScroll.c9142728.js";import{Q as X}from"./QPage.f04658ef.js";import{Q as G}from"./QPullToRefresh.e8308158.js";import{u as J}from"./CartStore.fe06611f.js";import"./QResizeObserver.3c3b4a7a.js";import"./touch.3df10340.js";import"./selection.c88e3f6c.js";import"./format.2bc25e5f.js";const K={name:"FeedPage",components:{MerchantListInline:h(()=>y(()=>import("./MerchantListInline.25d247d8.js"),["assets/MerchantListInline.25d247d8.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QImg.4e876ad6.js","assets/QChip.9a5e9391.js","assets/QItemLabel.b935a34d.js"])),MerchantListTpl:h(()=>y(()=>import("./MerchantListTpl.d6ba85c4.js"),["assets/MerchantListTpl.d6ba85c4.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QImg.4e876ad6.js","assets/QChip.9a5e9391.js"])),MerchantListSkeleton:h(()=>y(()=>import("./MerchantListSkeleton.cee3561c.js"),["assets/MerchantListSkeleton.cee3561c.js","assets/QSkeleton.8077f081.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QList.d8ad41f7.js"])),SortList:h(()=>y(()=>import("./SortList.a066f6d5.js"),["assets/SortList.a066f6d5.js","assets/QItemLabel.b935a34d.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QList.d8ad41f7.js"])),MerchantFilter:h(()=>y(()=>import("./MerchantFilter.e9c841b4.js"),["assets/MerchantFilter.e9c841b4.js","assets/QToolbarTitle.80059bbe.js","assets/index.30bcee2d.js","assets/index.aba08127.css","assets/QSpace.274cde1f.js","assets/QToolbar.8b90f7d3.js","assets/QBtnToggle.c946cab5.js","assets/QBtnGroup.d73b976b.js","assets/QPullToRefresh.e8308158.js","assets/touch.3df10340.js","assets/selection.c88e3f6c.js","assets/format.2bc25e5f.js","assets/QFooter.f2cd3c2a.js","assets/QResizeObserver.3c3b4a7a.js","assets/DeliverySched.7aa22819.js"])),NoResults:h(()=>y(()=>import("./NoResults.2631867e.js"),["assets/NoResults.2631867e.js","assets/QImg.4e876ad6.js","assets/index.30bcee2d.js","assets/index.aba08127.css"]))},data(){return{loading:!0,list_type:"",featured_id:"",data:[],cuisine:[],reviews:[],estimation:[],services:[],items_min_max:[],title:"",page:0,sort_by:"",total_found:0,filters:[],transactionType:"",menu_type:"column",cuisine_id:"",cuisine_name:"",page_title:"",promos:[],payload:["cuisine","reviews","estimation","services","items_min_max","offers","promo"]}},setup(){const e=J(),o=M();return{CartStore:e,DataStore:o}},watch:{menu_type(e,o){console.log(e),c.setStorage("listType",e)}},created(){this.transactionType=c.getStorage("transaction_type"),this.list_type=this.$route.query.query,this.featured_id=this.$route.query.featured_id,this.cuisine_id=this.$route.query.cuisine_id,this.cuisine_name=this.$route.query.cuisine_name,this.page_title=this.$route.query.page_title,this.cuisine_id>0&&(this.filters={cuisine:[this.cuisine_id]});let e=c.getStorage("listType");c.empty(e)||(this.menu_type=e),Object.keys(this.DataStore.featured_data).length<=0&&this.DataStore.getFeaturedList(),this.DataStore.hasDataCuisine()||this.DataStore.CuisineList()},computed:{hasData(){return this.data.length>0},switchIconList(){return this.menu_type=="list"?"grid_view":"reorder"}},methods:{refresh(e){e(),this.resetPagination()},getMerchantFeed(e,o){const g={list_type:this.list_type,featured_id:this.featured_id,place_id:c.getStorage("place_id"),payload:this.payload,page:e,sort_by:this.sort_by,filters:this.filters};this.list_type==="featured"&&(g.featured_id=this.featured_id),this.loading=!0,P.authenticated()?c.fetchDataByToken("getMerchantFeed2",g).then(t=>{this.page=e,t.code==1?(this.data.push(t.details.data),this.cuisine=t.details.cuisine,this.reviews=t.details.reviews,this.estimation=t.details.estimation,this.services=t.details.services,this.items_min_max=t.details.items_min_max,this.total_found=t.details.total_found,this.promos=t.details.promos):(this.total_found=t.details.total_found,this.$refs.nscroll&&this.$refs.nscroll.stop())}).catch(t=>{this.$refs.nscroll&&this.$refs.nscroll.stop(),this.total_found=0}).then(t=>{this.loading=!1,o()}):c.getMerchantFeed(g).then(t=>{this.page=e,t.code==1?(this.data.push(t.details.data),this.cuisine=t.details.cuisine,this.reviews=t.details.reviews,this.estimation=t.details.estimation,this.services=t.details.services,this.items_min_max=t.details.items_min_max,this.total_found=t.details.total_found,this.promos=t.details.promos):(this.total_found=t.details.total_found,this.$refs.nscroll&&this.$refs.nscroll.stop())}).catch(t=>{this.$refs.nscroll&&this.$refs.nscroll.stop(),this.total_found=0}).then(t=>{this.loading=!1,o()})},afterSelectsort(e){console.log("afterSelectsort=>"+e),this.sort_by=e,this.resetPagination(),this.page=0},applyFilter(e){this.filters=e,this.filters.transaction_type=this.transactionType,this.resetPagination(),this.page=0},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},filterAgain(){console.log("filterAgain"),this.$refs.merchant_filter.filter=!0}}},W={class:"row items-center justify-between no-wrap"},Y={class:"row items-center no-wrap full-width"},Z={class:"text-center q-pr-sm"},ee={key:0,class:"text-grey q-pt-sm q-pb-xs"},te={key:1,class:"row justify-center absolute-bottom"};function se(e,o,g,t,s,m){const L=u("NoResults"),x=u("DIV"),F=u("MerchantListInline"),Q=u("MerchantListTpl"),T=u("MerchantListSkeleton"),b=u("SortList"),A=u("MerchantFilter");return i(),f(G,{onRefresh:m.refresh},{default:n(()=>[r(O,{reveal:"","reveal-offset":"50",class:D({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:n(()=>[r(N,null,{default:n(()=>[r(k,{onClick:o[0]||(o[0]=d=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),r(B,{class:"text-weight-bold"},{default:n(()=>[t.DataStore.featured_data[this.featured_id]?(i(),a(l,{key:0},[p(_(t.DataStore.featured_data[this.featured_id]),1)],64)):s.cuisine_name?(i(),a(l,{key:1},[p(_(s.cuisine_name),1)],64)):s.page_title?(i(),a(l,{key:2},[p(_(s.page_title),1)],64)):R("",!0)]),_:1})]),_:1})]),_:1},8,["class"]),r(X,{padding:""},{default:n(()=>[r(x,{class:"q-pl-md q-pr-md"},{default:n(()=>[w("div",W,[r(k,{color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark","icon-size":"11px",unelevated:"","no-caps":"",size:"md",class:"radius10",onClick:o[1]||(o[1]=d=>this.$refs.sort_list.show_modal=!0)},{default:n(()=>[w("div",Y,[w("div",Z,[t.DataStore.sort_list[s.sort_by]?(i(),a(l,{key:0},[p(_(t.DataStore.sort_list[s.sort_by]),1)],64)):(i(),a(l,{key:1},[p(_(e.$t("Sort")),1)],64))]),r(S,{name:"las la-angle-down",size:"15px"})])]),_:1},8,["color","text-color"]),w("div",null,[r(k,{color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",unelevated:"","no-caps":"",round:"",size:"12px",class:"q-mr-sm",onClick:o[2]||(o[2]=d=>this.menu_type=this.menu_type=="list"?"column":"list")},{default:n(()=>[r(S,{name:m.switchIconList},null,8,["name"])]),_:1},8,["color","text-color"]),r(k,{color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",unelevated:"","no-caps":"",round:"",size:"12px",onClick:o[3]||(o[3]=d=>this.$refs.merchant_filter.filter=!0)},{default:n(()=>[r(S,{name:"tune"})]),_:1},8,["color","text-color"])])]),s.loading&&s.page<=0?(i(),a("div",ee,[r($,{type:"text",style:{width:"100px"}})])):(i(),a("div",{key:1,class:D(["text-grey q-pt-sm q-pb-xs",{"min-height-inherit flex flex-center q-pa-none":!m.hasData}])},[m.hasData?(i(),a(l,{key:0},[p(_(s.total_found)+" "+_(e.$t("restaurant")),1)],64)):(i(),f(L,{key:1,onFilterAgain:m.filterAgain},null,8,["onFilterAgain"]))],2))]),_:1}),r(U,{ref:"nscroll",onLoad:m.getMerchantFeed,offset:250},{loading:n(()=>[s.page<=0?(i(),f(T,{key:0})):(i(),a("div",te,[r(H,{color:"secondary",size:"40px"})]))]),default:n(()=>[r(j,{class:"no-wrap"},{default:n(()=>[(i(!0),a(l,null,q(s.data,d=>(i(),a(l,{key:d},[(i(!0),a(l,null,q(d,v=>C((i(),f(V,{key:v.merchant_id,clickable:"",onClick:z(ie=>this.$router.push({name:"menu",params:{slug:v.restaurant_slug}}),["stop"])},{default:n(()=>[s.menu_type==="list"?(i(),f(F,{key:0,items:v,cuisine:s.cuisine,reviews:s.reviews,estimation:s.estimation,services:s.services,items_min_max:s.items_min_max,promos:s.promos},null,8,["items","cuisine","reviews","estimation","services","items_min_max","promos"])):(i(),f(Q,{key:1,items:v,cuisine:s.cuisine,reviews:s.reviews,estimation:s.estimation,services:s.services,items_min_max:s.items_min_max,promos:s.promos},null,8,["items","cuisine","reviews","estimation","services","items_min_max","promos"]))]),_:2},1032,["onClick"])),[[E]])),128))],64))),128))]),_:1})]),_:1},8,["onLoad"]),r(b,{ref:"sort_list",onAfterSelectsort:m.afterSelectsort},null,8,["onAfterSelectsort"]),r(A,{ref:"merchant_filter",cuisine_data:t.DataStore.cuisine,onApplyFilter:m.applyFilter,onRunFilter:e.runFilter},null,8,["cuisine_data","onApplyFilter","onRunFilter"])]),_:1})]),_:1},8,["onRefresh"])}var ve=I(K,[["render",se]]);export{ve as default};
